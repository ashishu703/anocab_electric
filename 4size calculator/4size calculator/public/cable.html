<form onsubmit="return validateForm()" style="width: 100%; max-width: 100%; margin: 0 auto; display: flex; justify-content: center; align-items: center; flex-direction: column;">
    <table id="yourTableId" style="width:100%; margin: 5 auto;">
        <style>
            /* Standard styles */
            table {
                width: 50%;
                align-content: center;
                border-collapse: collapse;
                margin: 20px auto;
                max-width: 0%;
                margin-left: auto;
                margin-right: auto;
            }
            th, td {
                border: 1px solid black;
                padding: 8px;
                text-align: center;
                word-wrap: break-word;
                overflow-wrap: break-word;
                position: relative;
                font-size: 11pt;
            }
            input[type="text"] {
                width: 100%;
                height: 100%;
                padding: 4px;
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                margin: 0;
                font-size: 11pt;
                box-sizing: border-box;
            }
            /* Print-specific styles */
            table {
                width: 50%;
                align-content: center;
                border-collapse: collapse;
                margin: 20px auto;
                max-width: 50%;
                margin-left: 0px;
                margin-right: auto;
            }
            th, td {
                border: 1px solid black;
                padding: 8px;
                text-align: center;
                word-wrap: break-word;
                overflow-wrap: break-word;
                position: relative;
                font-size: 11pt;
            } 
            input[type="input"] {
                border: 1px solid collapse;
                width: auto;
                height: auto;
                padding: 4px;
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                margin: 0;
                font-size: 11pt;
                box-sizing: border-box;
            /* Print-specific styles */
        </style>
  <!-- header starts here-->
    <tr>
        <td colspan="12" style="border-right:0"><h2> <b>Price List for PVC Insulated Multicore Aluminium Cable</b></h2><h3><b>ANODE ELECTRIC PVT. LTD.</b></h3><p><b>Manufacture/Importer: Anocab <br>Registered Office: Plot No. 10, IT park, Bargi Hills, Jabalpur M.P.<br>Pincode:482003, State:Madhya Pradesh</b></p></td>
        <td style="border-left:0"><img src="../../../prodimg/anocab1.webp" alt="Anocab Logo" style="max-width: 150px; margin-top: 10px;"></td>
    </tr>
    <tr>
        <td colspan="3"><b>GSTIN:23AANCA7455R1ZX</b></td>
        <td colspan="5"><b>Mail:mgmt@anode@gmail.com</b></td>
        <td colspan="5"><b>Contact No: 18002700075</b></td>
    </tr>
    <tr>
        <td colspan="13"><B>MULTICORE CIRCULATE PVC INSULATED & SHEATHED CABLES WITH ALUMINIUM CONDUCTOR</B></td>
    </tr>
    <tr>
        <td colspan="4"><b>HSN CODE : 74081910</b></td>
        <td colspan="5">IS 694:2010</td>
        <td colspan="4"><b>CM/L=8200128908</b></td>
    </tr>
    <!-- header ends here-->
    <!-- main content starts here-->
    <tr>
        <td rowspan="2"><b>Image</b></td>
        <td rowspan="3"><b>Size</b></td>
        <td colspan="2"><b>N/O Wires & Dia. Of Each Wire</b></td>
        <td colspan="4" style="min-width: 200px;"><b>Current Carrying Capacity</b></td>
        <td><b>CR 20<SUP>o</SUP>C</b></td>
        <td colspan="4"><b>MRP/MTR*(GST PAID)</b></td>
    <tr>
        <td rowspan="2"><b>In MM</b></td>
        <td rowspan="2"><b>In INCH</b></td>
        <td colspan="2" style="min-width: 200px;"><b>BUNCHED AND ENCLOSED IN CONDUIT OR TRUNKING</b></td>
        <td colspan="2" style="min-width: 200px;"><b>CLIPPED DIRECT TO A SURFACE OR ON A CABLE TRAY, BUNCHED & UNENCLOSED</b></td>
        <td rowspan="2"><b>Î©/km</b></td>
        <td colspan="2"><b>2 CORE (AE00I/YY*)</b></td>
        <td><b>3 CORE (AE00J/YY*)</b></td>
        <td><b>4 CORE (AE00K/YY*)</b></td>
    </tr>
    <TR>
        <td rowspan="6"><img src="../../../all products table/image/PVC Insulated Multicore Aluminium Cable.png" alt="PVC Insulated Multicore Aluminium Cable" width="100%" height="100px"></td>
        <TD><B>2 CORE CABLE (AMP.)</B></TD>
        <TD><B>3/4 CORE CABLE (AMP.)</B></TD>
        <TD><B>2 CORE CABLE (AMP.)</B></TD>
        <TD><B>3/4 CORE CABLE (AMP.)</B></TD>
        <TD><B>FLAT</B></TD>
        <TD><B>ROUND</B></TD>
        <TD><B>ROUND</B></TD>
        <TD><B>ROUND</B></TD>
    </TR>
    <tr>
        
        <td style="min-width:100px"><b>2.5</b></td>
        <td><b>1.78</b></td>
        <td><b>0.07</b></td>
        <td ><B>16</B></td>
        <td ><B>14</B></td>
        <td ><B>19</B></td>
        <td ><B>17</B></td>
        <td ><B>12.10</B></td>
        <td><input type="input"></td>
        <td><input type="input"></td>
        <td><input type="input"></td>
        <td><input type="input"></td>
    </tr>
    <tr>
        <td 20px><b>4.0</b></td>
        <td><b>2.25</b></td>
        <td><b>0.088</b></td>
        <td><b>21</b></td>
        <td><b>19</b></td>
        <td ><B>26</B></td>
        <td ><B>23</B></td>
        <td><b>7.41</b></td>
        <td><input type="input"></td>
        <td><input type="input"></td>
        <td><input type="input"></td>
        <td><input type="input"></td>
    </tr>
    <tr>
        <td><b>6.0</b></td>
        <td><b>2.76</b></td>
        <td><b>0.108</b></td>
        <td><b>27</b></td>
        <td><b>24</b></td>
        <td><b>32</b></td>
        <td ><B>28</B></td>
        <td ><B>4.61</B></td>
        <td><input type="input"></td>
        <td><input type="input"></td>
        <td><input type="input"></td>
        <td><input type="input"></td>
    </tr>
    <tr>
        <td><b>10.0</b></td>
        <td><b>3.56</b></td>
        <td><b>0.14</b></td>
        <td><b>37</b></td>
        <td><b>32</b></td>
        <td><b>42</b></td>
        <td><B>37</B></td>
        <td><B>4.05</B></td>
        <td><input type="input"></td>
        <td><input type="input"></td>
        <td><input type="input"></td>
        <td><input type="input"></td>
    </tr>
    <tr>
        <td><b>16.0</b></td>
        <td><b>4.15</b></td>
        <td><b>0.177</b></td>
        <td><b>50</b></td>
        <td><b>44</b></td>
        <td><B>58</B></td>
        <td><B>52</B></td>
        <td><b>1.91</b></td>
        <td><input type="input"></td>
        <td><input type="input"></td>
        <td><input type="input"></td>
        <td><input type="input"></td>
    </tr>
    
    <tr>
        <td colspan ="13"></td>
    </tr>
    <!-- main content ends here-->
    <!-- Footer starts here-->
    <tr>
        <td colspan ="13"><b>TERMS AND CONDITIONS<SUP>*</SUP></b></td>
    </tr>
    <tr>
        <td colspan ="13" style="text-align:left;"><b>*The above rates are GST Paid Rate  & any other statuory levies which shall be charged extra.
            <br>*Delivery : F.O.R. destination by road transport for order value above Rs. 2,00,000/- 
            <br>*On To Pay basis for order values up to Rs. 2,00,000/- </b>
        </td>
    </tr>
    <tr>
        <td colspan ="13"><b>PRODUCT DESCRIPTION</b></td>
    </tr>
    <tr text-align="left">
        <td colspan ="13" style="text-align:left;"><b>
            *Reference : IS 694:2010. <br>
            *Voltage Grade : Up to and Including 450/750V.<br>
            *Conductor : EC grade Annealed Aluminium Class 1& 2 As Per IS 8130<br>
            *Insulation : PVC Type- A, As per 5831.<br> 
            *Colour Of Core:Red & Black For 2 Core Cable ,Red, Yellow, Blue for 3 Core Cable , & Red, Yellow, Blue & Black For 4 Core Cable<br>
            *Sheath:PVC Type ST-I, PVC Type-ST2 as per IS 5831.
            *Colour of Sheath : Black And Other Colour As Per Customer Demand
            *Marking : The Cables Are Printed With Marking of 'ANOCAB'.<br>
            *Packing : Standard Packing of 500 Mtr. In Coil. & Other Length Available on Request, Cables are Printed With Marking Of 'ANOCAB'</b>
    </td>
    </tr>
</tr>
<tr>
    <td colspan="13"><img src="../../../prodimg/footer image form.webp" alt="footer image form" width="50%" height="100%"></td>
</tr>

<tr>
    <td colspan ="13" style="border-top:0"><br></td>
</tr>


<tr BGCOLOR="BLACK">
    <td style="color: white;" colspan="13">THE PRICES ARE SUBJECT TO CHANGE WITHOUT PRIOR NOTICE</td>
</tr>

</table>
<button id="printButton" onclick="printTable()">Download Table</button>
<script>
async function fetchPrices() {
    try {
        const response = await fetch('http://localhost:5000/api/prices?coreType=cable');
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        const prices = await response.json();
        console.log('Fetched prices:', prices);
        return prices;
    } catch (error) {
        console.error('Error fetching prices:', error);
        alert('Failed to fetch prices. Please check console for details.');
        return [];
    }
}

async function updatePrices() {
    try {
        // First clear all price fields
        const allInputs = document.querySelectorAll('input[type="input"]');
        allInputs.forEach(input => input.value = '-');
        
        const prices = await fetchPrices();
        if (prices.length === 0) {
            console.warn('No prices received from server');
            return;
        }

        console.log('Processing prices:', prices);

        const rows = document.querySelectorAll('table tr');
        
        rows.forEach(row => {
            const sizeCell = row.querySelector('td:first-child');
            if (sizeCell && sizeCell.textContent.trim()) {
                const sizeText = sizeCell.textContent.trim();
                
                // Only process rows with valid numeric sizes
                if (!isNaN(sizeText) && sizeText !== '') {
                    const size = parseFloat(sizeText);
                    console.log(`Processing size: ${size}`);
                    
                    const priceData = prices.find(p => p.size === size);
                    
                    if (priceData) {
                        console.log(`Found price data for size ${size}:`, priceData);
                        const inputs = row.querySelectorAll('input[type="input"]');
                    if (inputs.length === 4) {
                        // Find prices for each core type with debug logging
                        const twoCoreFlat = prices.find(p => p.size === size && p.coreType === '2core-flat');
                        const twoCoreRound = prices.find(p => p.size === size && p.coreType === '2core-round');
                        const threeCoreRound = prices.find(p => p.size === size && p.coreType === '3core-round');
                        const fourCoreRound = prices.find(p => p.size === size && p.coreType === '4core-round');

                        console.log('Price data found:', {
                            size,
                            twoCoreFlat,
                            twoCoreRound,
                            threeCoreRound,
                            fourCoreRound,
                        });

                        inputs[0].value = twoCoreFlat?.price || '-';
                        inputs[1].value = twoCoreRound?.price || '-';
                        inputs[2].value = threeCoreRound?.price || '-';
                        inputs[3].value = fourCoreRound?.price || '-';
                    } else {
                        console.warn(`Expected 4 price columns but found ${inputs.length} for size ${size}`);
                    }



                    } else {
                        console.warn(`No price data found for size ${size}`);
                    }
                }
            }
        });

        console.log('Prices updated successfully');
    } catch (error) {
        console.error('Error updating prices:', error);
        alert('Failed to update prices. Please check console for details.');
    }
}

function printTable() {
    var printContents = document.getElementById('yourTableId').outerHTML; 
    var originalContents = document.body.innerHTML;

    document.body.innerHTML = printContents;

    window.print();

    document.body.innerHTML = originalContents;
}

// Initialize prices when page loads and add error handling
document.addEventListener('DOMContentLoaded', () => {
    try {
        updatePrices();
    } catch (error) {
        console.error('Initial price load failed:', error);
        alert('Failed to load initial prices. Please check console for details.');
    }
});

</script>

<style>
@media print {
    @page {
        size: A4;
        margin: 8mm;
        min-width: 0%;
    }
    body {
        margin: 0;
        transform: scale(0.0);
        transform-origin: auto;
    }
    input[type="text"][data-source="backend"] {
        border: 1px solid black;
        padding: 5px;
        font-size: 10pt;
    }
    input:not([type="text"][data-source="backend"]) {
        display: none;
    }
}
}
</style>
</form>
</body>
</html>